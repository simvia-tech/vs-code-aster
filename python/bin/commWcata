#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Copyright 2016 EDF R&D
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License Version 3 as
# published by the Free Software Foundation.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, you may download a copy of license
# from https://www.gnu.org/licenses/gpl-3.0.

"""Convert Code_Aster COMM file(s) into AsterStudy document."""

import argparse
import os
import os.path as osp
import sys
import traceback

LIBDIR = '@LIBDIR@'

# Add libdir to sys.path...
if LIBDIR != '@' 'LIBDIR' '@':
    # ... for install tree.
    if not osp.isabs(LIBDIR):
        LIBDIR = osp.join(osp.dirname(osp.realpath(__file__)), LIBDIR)
        LIBDIR = osp.abspath(LIBDIR)
    sys.path.insert(0, LIBDIR)
else:
    # ... for source tree.
    sys.path.insert(0, osp.dirname(osp.realpath(__file__)))

def main(): # pragma pylint: disable=too-many-locals
    """Main function."""
    try:
        from asterstudy.datamodel.catalogs import CATA
    except ImportError as err:
        print('abort: could not find astergui libraries in [%s]' % ' '.join(sys.path),
              file=sys.stderr)
        print('(check your install and PYTHONPATH)', file=sys.stderr)
        if int(os.getenv('DEBUG', '0')):
            print('ERROR: %s' % err, file=sys.stderr)
            traceback.print_exc()
        return -1
    cmd_obj = CATA.get_command_obj('LIRE_MAILLAGE')
    parsed_cmd = CATA.parse_command(cmd_obj,{'FORMAT':'IDEAS'})
    CATA.print_pretty_command(parsed_cmd)
    print()
    print(CATA.get_command_definition('LIRE_MAILLAGE',{'FORMAT':'MED'}))


if __name__ == '__main__':
    sys.exit(main())
